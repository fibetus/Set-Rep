<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Edit Workout - Set & Rep</title>
    <link rel="stylesheet" type="text/css" href="/static/css/style.css">
</head>
<body>
    <nav>
        <button onclick="window.location.href='index.html'">Home</button>
    </nav>
    <div class="main-container">
        <h1>Edit Workout</h1>
        <form id="edit-workout-form">
            <div id="workout-exercises"></div>
            <div style="margin-top:20px;">
                <button type="submit">Accept Changes</button>
                <button type="button" onclick="window.cancelWorkoutChanges()">Cancel Changes</button>
            </div>
        </form>
    </div>
    <script type="text/javascript" src="/static/js/api.js"></script>
    <script type="text/javascript">
    document.addEventListener('DOMContentLoaded', async () => {
        const urlParams = new URLSearchParams(window.location.search);
        const workoutId = urlParams.get('id');
        if (!workoutId) {
            window.location.href = 'index.html';
            return;
        }
        // Load workout data
        const workout = await apiRequest(`workouts/${workoutId}/`);
        const container = document.getElementById('workout-exercises');
        container.innerHTML = '';
        workout.exercises.forEach((ex, i) => {
            const div = document.createElement('div');
            div.className = 'exercise-block';
            div.innerHTML = `<h3>${ex.exercise.name}</h3>`;
            ex.sets.forEach((set, j) => {
                div.innerHTML += `<div>Set ${set.set_number}: <input type='number' value='${set.reps}' min='1' id='reps-${i}-${j}' style='width:60px;'> reps, <input type='number' value='${set.weight}' min='0' step='0.01' id='weight-${i}-${j}' style='width:80px;'> kg</div>`;
            });
            container.appendChild(div);
        });
        document.getElementById('edit-workout-form').onsubmit = async (e) => {
            e.preventDefault();
            // Collect updated sets
            const updatedExercises = workout.exercises.map((ex, i) => ({
                exercise_id: ex.exercise.id,
                sets: ex.sets.map((set, j) => ({
                    reps: parseInt(document.getElementById(`reps-${i}-${j}`).value),
                    weight: parseFloat(document.getElementById(`weight-${i}-${j}`).value)
                }))
            }));
            await apiRequest(`workouts/${workoutId}/`, 'PUT', { exercises: updatedExercises });
            window.location.href = 'index.html';
        };
    });
    window.cancelWorkoutChanges = function() {
        window.location.href = 'index.html';
    };
    </script>
</body>
</html> 